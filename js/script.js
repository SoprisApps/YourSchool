var id = "dba3511f-32ef-486f-ade2-7540ae28922e";
var school = {
    "dba3511f-32ef-486f-ade2-7540ae28922e": {
        "id": "dba3511f-32ef-486f-ade2-7540ae28922e",
        "parent_id": "root",
        "user_id": "root",
        "title": "Ross Montessori School",
        "created": "2015-02-11 06:44:28.098659+00",
        "modified": "2016-08-15 22:52:10.147496+00",
        "type": "school",
        "is_private": false,
        "deleted": false,
        "path": "root.dba3511f32ef486fade27540ae28922e",
        "is_live": true,
        "url_path": null,
        "category_ids": "{2}",
        "locations": [
            {
                "id": 1191,
                "address": "407 MERRILL AVE",
                "address2": null,
                "city": "CARBONDALE",
                "state": "CO",
                "zip": 23200,
                "zip4": null,
                "coordinates": "(39.404388,-107.211195)",
                "phone": 9709637198,
                "is_primary": true,
                "sponsor_id": null,
                "organization_id": "dba3511f-32ef-486f-ade2-7540ae28922e",
                "fax": null
            }
        ],
        "thirdPartyLinks": [
            {
                "id": 1,
                "type": "url",
                "value": "http://www.rossmontessori.org"
            },
            {
                "id": 2,
                "type": "facebook.url",
                "value": "https://www.facebook.com/#!/pages/Ross-Montessori-Charter-School/123178844400497"
            },
            {
                "id": 3,
                "type": "twitter.url",
                "value": "https://twitter.com/RossMontessori"
            }
        ],
        "blocks": [
            {
                "id": 1,
                "type": "message",
                "items": [
                    {
                        "title": "About Ross Montessori",
                        "message": "The mission of Ross Montessori School is to prepare compassionate life-long learners to have a positive impact on the world.We envision a time when Ross Montessori School will be an exemplary educational institution and recognized as such all over the world. Educators from all backgrounds will observe and learn from our model, grounded in the Montessori Method. Parents will choose our school over any other with a steadfast belief in the value we create for the children, families and communities we serve.",
                        "url": "http://www.rossmontessori.org",
                        "image": null,
                        "displayTextUnderImage": null
                    }
                ]
            },
            {
                "id": 2,
                "type": "video",
                "title": "SchoolBlocks Intro",
                "url": "https://youtu.be/xdl0UWk-1FQ",
                "embedUrl": "https://youtu.be/xdl0UWk-1FQ?modestbranding=1&showinfo=0&rel=0"
            },
            {
                "id": 3,
                "type": "eventlist",
                "title": "Featured Events",
                "url": "http://www.rossmontessori.org/calendar/f3eb4194-d7df-4f3a-8e8d-5b32e77022ea",
                "items": [
                    {
                        "title": "Beginning of the Year Party",
                        "description": "Come join us at the <em>Beginning of the Year Party!</em>",
                        "url": null,
                        "attachments": false,
                        "location": "RMS, 109 Lewies Lane, Carbondale, CO 81623",
                        "allDay": false,
                        "multiDay": false,
                        "timezone": "America/Denver",
                        "start": "2016-10-21 09:30:00",
                        "end": "2016-10-21 10:30:00"
                    },
                    {
                        "title": "Thanksgiving",
                        "description": null,
                        "url": null,
                        "attachments": false,
                        "location": "RMS, 109 Lewies Lane, Carbondale, CO 81623",
                        "allDay": true,
                        "multiDay": false,
                        "timezone": "America/Denver",
                        "start": "2016-11-24 00:00:00",
                        "end": "2016-11-24 00:00:00"
                    },
                    {
                        "title": "Winter Break",
                        "description": "We have a couple of weeks off.  Yippee!",
                        "url": "https://www.nps.gov/index.htm",
                        "attachments": false,
                        "location": "RMS, 109 Lewies Lane, Carbondale, CO 81623",
                        "allDay": true,
                        "multiDay": true,
                        "timezone": "America/Denver",
                        "start": "2016-12-20 00:00:00",
                        "end": "2017-01-04 00:00:00"
                    },
                    {
                        "title": "Christmas",
                        "description": null,
                        "url": null,
                        "attachments": false,
                        "location": null,
                        "allDay": true,
                        "multiDay": false,
                        "timezone": "America/Denver",
                        "start": "2016-12-25 00:00:00",
                        "end": "2016-12-25 00:00:00"
                    }
                ]
            },
            {
                "id": 4,
                "type": "newsstream",
                "items": [
                    {
                        "title": "Ross Kids are the Smartest!",
                        "description": "This great website shows how Ross kids are the smartest.",
                        "url": "http://www.rossmontessori.org",
                        "image": "https://scontent.fsnc1-1.fna.fbcdn.net/t31.0-8/14310317_1281527738565596_6564701507888292348_o.jpg",
                        "timezone": "America/Denver",
                        "timestamp": "2016-09-11 09:30:32"
                    },
                    {
                        "title": "The Middle School is off for their camping trip. Have a great time everyone!",
                        "description": null,
                        "url": "https://www.facebook.com/rossmontessori/photos/a.204351582949889.65495.123178844400497/1285843474800689/?type=3&theater",
                        "image": "https://scontent.fsnc1-1.fna.fbcdn.net/t31.0-8/14324283_1285843474800689_6177427745886358701_o.jpg",
                        "timezone": "America/Denver",
                        "timestamp": "2016-09-04 09:30:32"
                    },
                    {
                        "title": "Montessori Education & My Child",
                        "description": null,
                        "url": "http://amshq.org/Family-Resources/Montessori-Education-and-Your-Child",
                        "image": null,
                        "timezone": "America/Denver",
                        "timestamp":  "2016-09-01 14:10:00"
                    }
                ]
            },
            {
                "id": 5,
                "type": "quicklink",
                "items": [
                    {
                        "title": "Pancakes",
                        "url": "http://www.google.com",
                        "image": "https://parakeetweb.s3.amazonaws.com/images/stickers/Stickers/Pancakes.png"
                    },
                    {
                        "title": "Waffles",
                        "url": "http://www.bing.com",
                        "image": "https://parakeetweb.s3.amazonaws.com/images/stickers/Stickers/Waffles.png"
                    },
                    {
                        "title": "BLT Sandwich",
                        "url": "http://www.duckduckgo.com",
                        "image": "https://parakeetweb.s3.amazonaws.com/images/stickers/Stickers/BLT%20Sandwich.png"
                    }
                ]
            }
        ]
    }
};
var blocks = school[id].blocks;
function getSocialLinks(){
   var facebook = school[id].thirdPartyLinks[1];
   var twitter = school[id].thirdPartyLinks[2];
   $("#facebook-link").attr('href',facebook.value);
   $("#twitter-link").attr('href',twitter.value);
   $("#school-name").html(school[id].title);
}
function getAboutData(){
   var msg = blocks[0].items[0].message;
   var title = blocks[0].items[0].title;
   $("#abt-text").html(msg.substring(0,400)+"...");
   $("#abt-title").html("<span class=\"text\">"+title.substring(0,title.indexOf(" "))+"</span>"+title.substring(title.indexOf(" ")));
   $(".text a.btn-large").attr('href',blocks[0].items[0].url)
}
function getEventHTML(object,index,n){
   var code = "";
   //Event Code Start
   code += "<div id=\"event-"+(index+1)+"\" class=\"f-event\">";
      if(object[index].start!=null){
         code += "<div class=\"date\"><p class=\"month\">"+getMonth(object[index].start)+"</p>";
         code += "<p class=\"_date\">"+object[index].start.substring(8,10)+"</p></div>";
      }
      else{
         code += "<div class=\"date\">";
         code += "<p class=\"month\">X</p></div>";
      }

   code += "<div class=\"body\">";

      if(object[index].title!=null){
         code += "<h3 class=\"event-title event\">"+object[index].title+"</h3>";
      }
      else{
         code += "<h3 class=\"event-title event\">Event "+(index+1)+"</h3>";
      }

      if(object[index].start!=null||object[index].location!=null){
   code += "<p class=\"time-venue\">"//2016-10-21 09:30:00
      if(object[index].start!=null&object[index].start.substring(11,16)!="00:00"){
         code += object[index].start.substring(11,16)+" ";
      }
      if(object[index].end!=null&&object[index].end.substring(11,16)!="00:00"){
            code += "- "+object[index].end.substring(11,16)+" ";
      }
      if(object[index].location!=null){
            code +="<i style=\"padding:0px 10px\" class=\"fa fa-map-marker\"></i>"+ object[index].location.substring(0,30)+"...";
      }
      code += "</p>";
      if(object[index].description!=null){
         code += "<p class=\"description\">"+object[index].description.substring(0,200)+"..."+"</p>";
      }
      else{
         code += "<p class=\"description\">Event Description Not Avilable</p>";
      }
   }
   code += "</div></div>";
   //Event Code End
   return code;
}
function getMonth(start){
   var month = "";
   var date = start.substring(5,7);
   switch(date){
      case "01": month = "JAN";break;
      case "02": month = "FEB";break;
      case "03": month = "MAR";break;
      case "04": month = "APR";break;
      case "05": month = "MAY";break;
      case "06": month = "JUN";break;
      case "07": month = "JUL";break;
      case "08": month = "AUG";break;
      case "09": month = "SEPT";break;
      case "10": month = "OCT";break;
      case "11": month = "NOV";break;
      case "12": month = "DEC";break;
   }
   return month;
}
function getFeaturedEvents(pod){
   var feEvents = school[id].blocks[2].items;
   console.log(getNumberOfSlides(feEvents,pod));
   var index = 0,code ="",j=1;
   var posts = feEvents.length;
   while(index<posts){
     var i=pod;
     code += "<div id=\"event-slide-"+j+"\"class=\"slide\">";
     while(i--) {
       code += getEventHTML(feEvents,index++);
       if(index==posts)break;
     }
     code+="</div>";
     if(index==posts)break;
     j++;
   }
   //feEvents.forEach( function(){
   //code+=getEventHTML(feEvents,index++);
   //});
   $(".featured-events").append(code);
}
function getNewsMonth(start){
   var month = "";
   var date = start.substring(5,7);
   switch(date){
      case "01": month = "January";break;
      case "02": month = "February";break;
      case "03": month = "March";break;
      case "04": month = "April";break;
      case "05": month = "May";break;
      case "06": month = "June";break;
      case "07": month = "July";break;
      case "08": month = "August";break;
      case "09": month = "September";break;
      case "10": month = "October";break;
      case "11": month = "November";break;
      case "12": month = "December";break;
   }
   return month;
}
function getNewsHTML(object,index){
   var code = "";
   //Event Code Start
   code += "<div id=\"news-"+(index+1)+"\" class=\"l-news\">";
   if(object[index].image!=null){
      code += "<div class=\"thumbnail\" style=\"background:url("+object[index].image+");background-position: center;background-size: cover;\"></div>"
   }
   else{
      code += "<div class=\"thumbnail\" style=\"background:url(assets/video-ph.png);background-position: center;background-size: cover;\"></div>"
   }
   code += "<div class=\"body\">";
      if(object[index].title!=null){
         code += "<h3 class=\"event-title\">"+object[index].title.substring(0,50)+"...</h3>";
      }
      else{
         code += "<h3 class=\"event-title\">Event "+(index+1)+"</h3>";
      }
      if(object[index].timestamp!=null){
      code += "<p class=\"time-venue\">"//2016-10-21 09:30:00
      code += getNewsMonth(object[index].timestamp)+", "+object[index].timestamp.substring(0,4);
      code += "</p>";
      }
      if(object[index].description!=null){
         code += "<p class=\"description\">"+object[index].description.substring(0,200)+"..."+"</p>";
      }
      else{
         code += "<p class=\"description\">Event Description Not Avilable</p>";
      }
      code += "</div></div>";
   //Event Code End
   return code;
}
function getLatestNews(pod){
   var news = school[id].blocks[3].items;
   var index = 0,code ="",j=1;
   var posts = news.length;
   while(index<posts){
     var i=pod;
     code += "<div id=\"news-slide-"+j+"\"class=\"slide\">";
     while(i--) {
       code += getNewsHTML(news,index++);
       if(index==posts)break;
     }
     code+="</div>";
     if(index==posts)break;
     j++;
   }
   //news.forEach( function(){
   //    code+=getNewsHTML(news,index++,pod);
   //});
   $(".latest-news").append(code);
}
function getNumberOfSlides(object,postsToDisplay){
  var i,posts = object.length;
  return parseInt(posts/postsToDisplay);
}
function hideSlides(){}
$(document).ready( function(){
   $(".loader").delay(1000).fadeOut();
   getSocialLinks();
   getAboutData();
   var no_of_posts;
   if($(document).width()>1024){
     no_of_posts = 3;
   }else if($(document).width()<=700){
     no_of_posts = 1;
   }else{
     no_of_posts = 2;
   }
   console.log($(document).width());
   getFeaturedEvents(no_of_posts);
   getLatestNews(no_of_posts);
   $(".slide").hide();
   $("#news-slide-1").show();
   $("#event-slide-1").show();
});
